{
  "$schema": "./features.schema.json",
  "version": "1.0.0",
  "description": "Basilisk AV Feature Tracking",
  "meta": {
    "project": "basilisk-av",
    "currentPhase": 6,
    "lastUpdated": "2025-01-08",
    "notes": "Phase 6 audit complete. 30/35 features implemented. Remaining: help overlay, production HUD enhancements."
  },
  "features": [
    {
      "id": "p6-inline-viz-infrastructure",
      "name": "Inline Visualization Infrastructure",
      "phase": 6,
      "category": "inline-viz",
      "status": "complete",
      "description": "Core infrastructure for inline visualization widgets",
      "completedDate": "2025-12-18",
      "files": ["src/services/visualizationManager.ts", "src/hooks/useWidgetUpdates.ts", "src/services/strudelEngine.ts", "src/components/StrudelRepl.tsx"],
      "passes": true
    },
    {
      "id": "p6-inline-scope",
      "name": "Inline Scope Visualization (._scope())",
      "phase": 6,
      "category": "inline-viz",
      "status": "complete",
      "description": "Oscilloscope waveform visualization using Web Audio API analyser",
      "completedDate": "2025-12-18",
      "testCommand": "s(\"bd sd hh sd\")._scope()",
      "passes": true
    },
    {
      "id": "p6-inline-pianoroll",
      "name": "Inline Pianoroll Visualization (._pianoroll())",
      "phase": 6,
      "category": "inline-viz",
      "status": "complete",
      "description": "Horizontal piano roll showing note events over time",
      "completedDate": "2025-12-18",
      "testCommand": "note(\"c e g\")._pianoroll({ cycles: 2 })",
      "passes": true
    },
    {
      "id": "p6-inline-punchcard",
      "name": "Inline Punchcard Visualization (._punchcard())",
      "phase": 6,
      "category": "inline-viz",
      "status": "complete",
      "description": "Vertical piano roll (punchcard style) showing note events",
      "completedDate": "2025-12-18",
      "testCommand": "note(\"c a f e\").euclid(5,8)._punchcard()",
      "passes": true
    },
    {
      "id": "p6-inline-spiral",
      "name": "Inline Spiral Visualization (._spiral())",
      "phase": 6,
      "category": "inline-viz",
      "status": "complete",
      "completedDate": "2025-12-21",
      "description": "Spiral visualization showing pattern events as arcs on a spiral",
      "testCommand": "note(\"c e g b\")._spiral()",
      "passes": true
    },
    {
      "id": "p6-inline-spectrum",
      "name": "Inline Spectrum Visualization (._spectrum())",
      "phase": 6,
      "category": "inline-viz",
      "status": "complete",
      "completedDate": "2025-12-20",
      "description": "Frequency spectrum analyzer (FFT) visualization",
      "testCommand": "s(\"bd sd hh sd\")._spectrum()",
      "passes": true
    },
    {
      "id": "p6-theme-context",
      "name": "Theme Context Provider",
      "phase": 6,
      "category": "dark-mode",
      "status": "complete",
      "description": "React context for theme state management with localStorage persistence",
      "completedDate": "2025-12-21",
      "files": ["src/contexts/ThemeContext.tsx", "src/App.tsx"],
      "passes": true
    },
    {
      "id": "p6-theme-toggle-button",
      "name": "Theme Toggle Button",
      "phase": 6,
      "category": "dark-mode",
      "status": "complete",
      "description": "Sun/Moon toggle button in header to switch themes",
      "completedDate": "2025-12-21",
      "passes": true
    },
    {
      "id": "p6-repl-dark-background",
      "name": "REPL Dark Mode Styling",
      "phase": 6,
      "category": "dark-mode",
      "status": "complete",
      "description": "REPL window uses semi-transparent glassmorphism in dark mode",
      "completedDate": "2025-12-21",
      "passes": true
    },
    {
      "id": "p6-codemirror-dark-theme",
      "name": "CodeMirror Dark Theme",
      "phase": 6,
      "category": "dark-mode",
      "status": "complete",
      "description": "Custom CodeMirror theme with muted syntax colors for dark mode",
      "completedDate": "2025-12-21",
      "passes": true
    },
    {
      "id": "p6-header-dark-adaptation",
      "name": "Header Dark Mode Styling",
      "phase": 6,
      "category": "dark-mode",
      "status": "complete",
      "description": "AppHeader uses transparent glassmorphism in dark mode",
      "completedDate": "2025-12-21",
      "passes": true
    },
    {
      "id": "p6-hud-dark-styling",
      "name": "HUD Dark Mode Styling",
      "phase": 6,
      "category": "dark-mode",
      "status": "complete",
      "description": "HUD uses semi-transparent background in dark mode",
      "completedDate": "2025-12-21",
      "passes": true
    },
    {
      "id": "p6-dark-mode-css-fallbacks",
      "name": "Dark Mode CSS Fallbacks",
      "phase": 6,
      "category": "dark-mode",
      "status": "complete",
      "description": "CSS overrides for Strudel REPL components",
      "completedDate": "2025-12-21",
      "passes": true
    },
    {
      "id": "p6-sample-panel-base",
      "name": "Sample Panel Base Component",
      "phase": 6,
      "category": "shared-components",
      "status": "complete",
      "description": "Shared base component for Sound Browser and User Library panels",
      "completedDate": "2025-01-08",
      "files": ["src/components/shared/SamplePanel.tsx", "src/components/shared/SampleSearch.tsx"],
      "passes": true
    },
    {
      "id": "p6-sound-list",
      "name": "Sound Browser List",
      "phase": 6,
      "category": "sound-browser",
      "status": "complete",
      "description": "Sound menu displaying all loaded Strudel samples",
      "completedDate": "2025-01-08",
      "files": ["src/components/sound-browser/SoundBrowserTray.tsx", "src/components/sound-browser/SoundSampleGrid.tsx", "src/components/sound-browser/SoundCategoryChips.tsx"],
      "passes": true
    },
    {
      "id": "p6-sound-search",
      "name": "Sound Browser Search",
      "phase": 6,
      "category": "sound-browser",
      "status": "complete",
      "description": "Searchable/filterable sound list",
      "completedDate": "2025-01-08",
      "files": ["src/components/sound-browser/SoundSearch.tsx"],
      "passes": true
    },
    {
      "id": "p6-sound-preview",
      "name": "Sound Browser Preview",
      "phase": 6,
      "category": "sound-browser",
      "status": "complete",
      "description": "Preview sounds on click",
      "completedDate": "2025-01-08",
      "files": ["src/hooks/useSoundPreview.ts"],
      "passes": true
    },
    {
      "id": "p6-sound-toggle-button",
      "name": "Sound Browser Toggle Button",
      "phase": 6,
      "category": "sound-browser",
      "status": "complete",
      "description": "Music icon button to toggle Sound Browser panel",
      "completedDate": "2025-01-08",
      "files": ["src/components/StrudelRepl.tsx"],
      "passes": true
    },
    {
      "id": "p6-sound-insert",
      "name": "Sound Browser Insert",
      "phase": 6,
      "category": "sound-browser",
      "status": "complete",
      "description": "Insert sample name into editor on double-click",
      "completedDate": "2025-01-08",
      "files": ["src/components/StrudelRepl.tsx"],
      "passes": true
    },
    {
      "id": "p6-user-library-button",
      "name": "User Library Toggle Button",
      "phase": 6,
      "category": "user-library",
      "status": "complete",
      "description": "User Library toggle button in header with waveform icon",
      "completedDate": "2025-01-08",
      "files": ["src/components/StrudelRepl.tsx"],
      "passes": true
    },
    {
      "id": "p6-user-library-panel",
      "name": "User Library Panel",
      "phase": 6,
      "category": "user-library",
      "status": "complete",
      "description": "User Library panel displaying user's linked sample directories",
      "completedDate": "2025-01-08",
      "files": ["src/components/user-library/UserLibraryTray.tsx", "src/components/user-library/DirectoryTree.tsx"],
      "passes": true
    },
    {
      "id": "p6-panel-exclusivity",
      "name": "Panel Mutual Exclusivity",
      "phase": 6,
      "category": "user-library",
      "status": "complete",
      "description": "Only one panel (Sound Browser or User Library) open at a time",
      "completedDate": "2025-01-08",
      "files": ["src/hooks/usePanelExclusivity.ts"],
      "passes": true
    },
    {
      "id": "p6-user-library-link",
      "name": "User Library Directory Link",
      "phase": 6,
      "category": "user-library",
      "status": "complete",
      "description": "Link master user directory of sounds (local or CDN)",
      "completedDate": "2025-01-08",
      "files": ["src/components/user-library/LinkDirectoryPrompt.tsx", "src/components/user-library/CDNUrlInput.tsx", "src/hooks/useFileSystemAccess.ts", "src/hooks/useCDNSamples.ts"],
      "passes": true
    },
    {
      "id": "p6-user-library-preview",
      "name": "User Library Preview",
      "phase": 6,
      "category": "user-library",
      "status": "complete",
      "description": "Preview user samples on click via Web Audio API",
      "completedDate": "2025-01-08",
      "files": ["src/components/StrudelRepl.tsx"],
      "passes": true
    },
    {
      "id": "p6-user-library-insert",
      "name": "User Library Insert",
      "phase": 6,
      "category": "user-library",
      "status": "complete",
      "description": "Insert user sample path into editor on double-click",
      "completedDate": "2025-01-08",
      "files": ["src/components/StrudelRepl.tsx"],
      "passes": true
    },
    {
      "id": "p6-user-library-search",
      "name": "User Library Search",
      "phase": 6,
      "category": "user-library",
      "status": "complete",
      "description": "Search user samples with real-time filtering",
      "completedDate": "2025-01-08",
      "files": ["src/hooks/useUserLibrary.ts", "src/components/shared/SampleSearch.tsx"],
      "passes": true
    },
    {
      "id": "p6-shortcut-engine-start",
      "name": "Engine Start Shortcut",
      "phase": 6,
      "category": "keyboard",
      "status": "complete",
      "description": "Ctrl+Shift+Space to start Strudel engine",
      "completedDate": "2025-01-08",
      "files": ["src/App.tsx", "src/hooks/useGlobalKeyboardShortcuts.ts"],
      "passes": true
    },
    {
      "id": "p6-shortcut-halt",
      "name": "Emergency Halt Shortcut",
      "phase": 6,
      "category": "keyboard",
      "status": "complete",
      "description": "Escape key immediately stops all audio",
      "completedDate": "2025-01-08",
      "files": ["src/App.tsx", "src/hooks/useGlobalKeyboardShortcuts.ts"],
      "passes": true
    },
    {
      "id": "p6-shortcut-hide-repl",
      "name": "Hide REPL Shortcut",
      "phase": 6,
      "category": "keyboard",
      "status": "complete",
      "description": "Ctrl+H toggles REPL visibility",
      "completedDate": "2025-01-08",
      "files": ["src/App.tsx", "src/hooks/useREPLVisibility.ts"],
      "passes": true
    },
    {
      "id": "p6-shortcut-help",
      "name": "Keyboard Shortcut Help Overlay",
      "phase": 6,
      "category": "keyboard",
      "description": "Help overlay showing all available keyboard shortcuts",
      "priority": "low",
      "dependencies": ["p6-shortcut-engine-start", "p6-shortcut-halt", "p6-shortcut-hide-repl"],
      "verification": [
        "Shortcut (e.g., ?) opens help overlay",
        "Overlay lists all available shortcuts",
        "Overlay dismisses on Escape or click-away",
        "Overlay styled consistently with glassmorphism",
        "Shortcuts grouped by category"
      ],
      "passes": false
    },
    {
      "id": "p6-hud-fft-bands",
      "name": "HUD FFT Bands Display",
      "phase": 6,
      "category": "production-hud",
      "description": "Compact FFT analyzer showing all 4 a.fft bands",
      "priority": "medium",
      "dependencies": [],
      "verification": [
        "4 mini visualizers shown (a.fft[0-3])",
        "Each bar responds to its frequency band",
        "Visualizers update in real-time",
        "Positioned non-intrusively (corner)",
        "Labels identify each band"
      ],
      "notes": "Currently only shows a.fft[0]. Needs expansion to all 4 bands.",
      "passes": false
    },
    {
      "id": "p6-hud-cpu",
      "name": "HUD CPU Display",
      "phase": 6,
      "category": "production-hud",
      "description": "CPU/processing power percentage display",
      "priority": "low",
      "dependencies": [],
      "verification": [
        "CPU percentage displayed in HUD",
        "Updates at reasonable interval (1-2s)",
        "Warns visually if CPU high (>80%)",
        "Uses Performance API accurately"
      ],
      "passes": false
    },
    {
      "id": "p6-hud-fps",
      "name": "HUD FPS Counter",
      "phase": 6,
      "category": "production-hud",
      "description": "FPS counter display",
      "priority": "medium",
      "dependencies": [],
      "verification": [
        "FPS counter visible in HUD",
        "Shows current frame rate",
        "Updates smoothly (rolling average)",
        "Warns if FPS drops below 30"
      ],
      "passes": false
    },
    {
      "id": "p6-hud-toggle",
      "name": "HUD Toggle Visibility",
      "phase": 6,
      "category": "production-hud",
      "description": "Toggle HUD visibility in production mode",
      "priority": "medium",
      "dependencies": ["p6-hud-fft-bands"],
      "verification": [
        "Button or shortcut toggles HUD",
        "HUD completely hidden when off",
        "Preference persists via localStorage",
        "Works in production (not just DEV mode)"
      ],
      "notes": "Currently HUD only visible in import.meta.env.DEV mode",
      "passes": false
    },
    {
      "id": "p6-hud-styling",
      "name": "HUD Minimal Styling",
      "phase": 6,
      "category": "production-hud",
      "description": "Minimal non-intrusive HUD design",
      "priority": "low",
      "dependencies": ["p6-hud-fft-bands", "p6-hud-fps"],
      "verification": [
        "HUD uses glassmorphism consistent with REPL",
        "Semi-transparent, doesn't block visuals",
        "Monochrome palette per basilisk-style",
        "Compact layout, minimal footprint"
      ],
      "passes": false
    }
  ],
  "summary": {
    "total": 35,
    "complete": 30,
    "pending": 5,
    "blocked": 0
  },
  "testingInstructions": {
    "prerequisites": [
      "Start the dev server: npm run dev",
      "Open http://localhost:5174 in browser",
      "Click 'Start Audio' button",
      "Open browser DevTools Console (F12) to view debug logs"
    ],
    "testPatterns": {
      "_scope": "s(\"bd sd hh sd\")._scope()",
      "_pianoroll": "note(\"c e g\")._pianoroll({ cycles: 2 })",
      "_punchcard": "note(\"c a f e\").euclid(5,8)._punchcard()",
      "_spiral": "note(\"c e g b\")._spiral()",
      "_spectrum": "s(\"bd sd hh sd\")._spectrum()"
    },
    "keyboardShortcuts": {
      "Escape": "Emergency halt - stops all audio",
      "Ctrl+Shift+Space": "Start Strudel engine",
      "Ctrl+H": "Toggle REPL visibility",
      "Ctrl+S": "Save script to file",
      "Shift+Enter": "Execute code (in editor)"
    }
  }
}
